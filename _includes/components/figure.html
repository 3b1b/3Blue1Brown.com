{%- if include.width -%}
  {%- capture size -%}width: {{ include.width }}{%- endcapture -%}
{%- elsif include.height -%}
  {%- capture size -%}height: {{ include.height }}{%- endcapture -%}
{%- else -%}
  {%- capture size -%}width: 100%{%- endcapture -%}
{%- endif -%}

<figure class="figure" data-show="{{ include.default | default: 'image' }}">
  {% if include.image and include.video %}
    <div class="figure_controls">
      <button
        onclick="this.closest('.figure').dataset.show = 'image'"
      >
        <i class="far fa-image"></i>
        <span>Still</span>
      </button>
      <button
        onclick="this.closest('.figure').dataset.show = 'video'"
      >
        <i class="fas fa-film"></i>
        <span>Animation</span>
      </button>
    </div>
  {% endif %}

  {% if include.image %}
    <img
      src="{{ include.image | relative_url }}"
      alt="{{ include.caption }}"
      style="{{ size }}"
      loading="lazy"
    />
  {% endif %}

  {% if include.video %}
    <video
      autoplay
      controls
      preload="metadata"
      style="{{ size }}"
    >
      <source
        src="{{ include.video | relative_url }}"
        type="video/mp4"
      >
    </video>
  {% endif %}
    
  {% if include.caption %}
    <figcaption class="figure_caption">
      {{ include.caption | markdownify | remove: "<p>" | remove: "</p>" }}
    </figcaption>
  {% endif %}
</figure>
